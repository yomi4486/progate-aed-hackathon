# version: '3.8' # âœ¨ è¶…çµ¶ã‚­ãƒ©ã‚­ãƒ©ãƒ»ã‚¤ã‚±ã‚¤ã‚±ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ãƒ‘ãƒã‚¨ï¼ğŸš€ğŸŒˆ
services: # ğŸ› ï¸ ã‚µãƒ¼ãƒ“ã‚¹ãŸã¡å¤§é›†åˆï¼ğŸ‰
  localstack: # ğŸ³ LocalStackã‚³ãƒ³ãƒ†ãƒŠï¼AWSã®é­”æ³•ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§âœ¨
    image: localstack/localstack:latest # ğŸ–¼ï¸ LocalStackã®æœ€æ–°ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼
    container_name: localstack_main # ğŸ“¦ ã‚³ãƒ³ãƒ†ãƒŠåã¯localstack_mainï¼
    ports:
      - "4566:4566"            # ğŸŒ 4566: ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¨ãƒƒã‚¸ãƒãƒ¼ãƒˆï¼
      - "4571:4571"            # ğŸ¦¸â€â™‚ï¸ 4571: ãƒ¬ã‚¬ã‚·ãƒ¼Lambdaç”¨ï¼ˆä½¿ã†ï¼Ÿä½¿ã‚ãªã„ï¼Ÿï¼‰
      - "9200:9200"            # ğŸ” 9200: OpenSearchã§æ¤œç´¢ã—ã¾ãã‚Šï¼
      - "3306:3306"            # ğŸ¬ 3306: Aurora MySQLã§DBã‚‚ãƒãƒƒãƒãƒªï¼
      - "8080:8080"            # ğŸ–¥ï¸ LocalStackãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    environment:
      - SERVICES=s3,dynamodb,lambda,sqs,opensearch,aurora,iam,logs,sns # ğŸ›ï¸ æœ‰åŠ¹åŒ–ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ï¼å¿…è¦ã«å¿œã˜ã¦è¿½åŠ OKï¼
      - DEBUG=1 # ğŸ ãƒ‡ãƒãƒƒã‚°ONï¼å›°ã£ãŸã‚‰ã“ã‚Œï¼
      - DATA_DIR=/tmp/localstack/data # ğŸ’¾ ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã§å®‰å¿ƒï¼
      - LAMBDA_EXECUTOR=docker # ğŸ³ Lambdaã¯Dockerã§å®Ÿè¡Œï¼
      - DOCKER_HOST=unix:///var/run/docker.sock # ğŸ› ï¸ Dockeré€£æºï¼
      - AWS_DEFAULT_REGION=as-northeast-1
      - AWS_ACCESS_KEY_ID=123456789
      - AWS_SECRET_ACCESS_KEY=123456789
      - LOCALSTACK_URL=http://localstack:4566
    healthcheck:
      test: nc -z 127.0.0.1 4566
      interval: "5s"
      timeout: "5s"
      start_period: "10s"
      retries: 3
    volumes:
      - "localstack_data:/var/lib/localstack" # ğŸ“‚ ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼
      - "/var/run/docker.sock:/var/run/docker.sock" # ğŸ³ Dockerã‚½ã‚±ãƒƒãƒˆå…±æœ‰ï¼

volumes:
  localstack_data: # ğŸ“¦ ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼å®‰å¿ƒ